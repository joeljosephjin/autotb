cross_validation: False
Preprocessing...
Preparing input...
Input was already prepared
Use `python3 -m tensorboard.main --logdir=./logs/` to visualize accuracy and AUC graphs in real time
Training...
Diversity of Training Set: Class 0: 132 Class 1: 28
Diversity of Validation Set: Class 0: 36 Class 1: 4
WARNING:tensorflow:From /content/tbcnn/train_loop.py:63: shuffle_and_repeat (from tensorflow.python.data.experimental.ops.shuffle_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.data.Dataset.shuffle(buffer_size, seed)` followed by `tf.data.Dataset.repeat(count)`. Static tf.data optimizations will take care of using the fused implementation.
WARNING:tensorflow:From /usr/local/lib/python3.7/dist-packages/tensorflow/python/autograph/impl/api.py:465: py_func (from tensorflow.python.ops.script_ops) is deprecated and will be removed in a future version.
Instructions for updating:
tf.py_func is deprecated in TF V2. Instead, there are two
    options available in V2.
    - tf.py_function takes a python function which manipulates tf eager
    tensors instead of numpy arrays. It's easy to convert a tf eager tensor to
    an ndarray (just call tensor.numpy()) but having access to eager tensors
    means `tf.py_function`s can use accelerators such as GPUs as well as
    being differentiable using a gradient tape.
    - tf.numpy_function maintains the semantics of the deprecated tf.py_func
    (it is not differentiable, and manipulates numpy arrays). It drops the
    stateful argument making all functions stateful.
WARNING:tensorflow:From /content/tbcnn/train_loop.py:69: DatasetV1.make_one_shot_iterator (from tensorflow.python.data.ops.dataset_ops) is deprecated and will be removed in a future version.
Instructions for updating:
This is a deprecated API that should only be used in TF 1 graph mode and legacy TF 2 graph mode available through `tf.compat.v1`. In all other situations -- namely, eager mode and inside `tf.function` -- you can consume dataset elements using `for elem in dataset: ...` or by explicitly creating iterator via `iterator = iter(dataset)` and fetching its elements via `values = next(iterator)`. Furthermore, this API is not available in TF 2. During the transition from TF 1 to TF 2 you can use `tf.compat.v1.data.make_one_shot_iterator(dataset)` to create a TF 1 graph mode style iterator for a dataset created through TF 2 APIs. Note that this should be a transient state of your code base as there are in general no guarantees about the interoperability of TF 1 and TF 2 code.
WARNING:tensorflow:From /content/tbcnn/net.py:17: The name tf.keras.initializers.he_normal is deprecated. Please use tf.compat.v1.keras.initializers.he_normal instead.
/content/tbcnn/net.py:21: UserWarning: `tf.layers.batch_normalization` is deprecated and will be removed in a future version. Please use `tf.keras.layers.BatchNormalization` instead. In particular, `tf.control_dependencies(tf.GraphKeys.UPDATE_OPS)` should not be used (consult the `tf.keras.layers.BatchNormalization` documentation).
  output = tf.layers.batch_normalization(output)
/usr/local/lib/python3.7/dist-packages/keras/legacy_tf_layers/normalization.py:455: UserWarning: `layer.apply` is deprecated and will be removed in a future version. Please use `layer.__call__` method instead.
  return layer.apply(inputs, training=training)
/content/tbcnn/net.py:35: UserWarning: `tf.layers.batch_normalization` is deprecated and will be removed in a future version. Please use `tf.keras.layers.BatchNormalization` instead. In particular, `tf.control_dependencies(tf.GraphKeys.UPDATE_OPS)` should not be used (consult the `tf.keras.layers.BatchNormalization` documentation).
  parallel = tf.layers.batch_normalization(parallel)
Parameter number: 231602
WARNING:tensorflow:From /content/tbcnn/net.py:98: auc (from tensorflow.python.ops.metrics_impl) is deprecated and will be removed in a future version.
Instructions for updating:
The value of AUC returned by this may race with the update so this is deprecated. Please use tf.keras.metrics.AUC instead.

















Epoch   0 | Time:  40 s | Acc: 0.825 (Test: 0.900) | AUC: 0.657 (Test: 0.510) | Precision: 0.000 (Test: 0.000)














Epoch   1 | Time:  31 s | Acc: 0.825 (Test: 0.900) | AUC: 0.698 (Test: 0.646) | Precision: 0.000 (Test: 0.000)















Epoch   2 | Time:  31 s | Acc: 0.825 (Test: 0.900) | AUC: 0.727 (Test: 0.677) | Precision: 0.000 (Test: 0.000)














Epoch   3 | Time:  31 s | Acc: 0.825 (Test: 0.900) | AUC: 0.769 (Test: 0.698) | Precision: 0.000 (Test: 0.000)















Epoch   4 | Time:  31 s | Acc: 0.825 (Test: 0.900) | AUC: 0.801 (Test: 0.708) | Precision: 0.000 (Test: 0.000)














Epoch   5 | Time:  32 s | Acc: 0.825 (Test: 0.900) | AUC: 0.769 (Test: 0.715) | Precision: 0.000 (Test: 0.000)















Epoch   6 | Time:  32 s | Acc: 0.825 (Test: 0.900) | AUC: 0.765 (Test: 0.715) | Precision: 0.000 (Test: 0.000)















Epoch   7 | Time:  32 s | Acc: 0.825 (Test: 0.900) | AUC: 0.799 (Test: 0.729) | Precision: 0.000 (Test: 0.000)















Epoch   8 | Time:  34 s | Acc: 0.825 (Test: 0.900) | AUC: 0.766 (Test: 0.733) | Precision: 0.000 (Test: 0.000)















Epoch   9 | Time:  32 s | Acc: 0.825 (Test: 0.900) | AUC: 0.814 (Test: 0.743) | Precision: 0.000 (Test: 0.000)















Epoch  10 | Time:  32 s | Acc: 0.831 (Test: 0.900) | AUC: 0.859 (Test: 0.764) | Precision: 1.000 (Test: 0.000)
















Epoch  11 | Time:  33 s | Acc: 0.844 (Test: 0.900) | AUC: 0.879 (Test: 0.760) | Precision: 1.000 (Test: 0.000)















Epoch  12 | Time:  32 s | Acc: 0.856 (Test: 0.950) | AUC: 0.856 (Test: 0.812) | Precision: 1.000 (Test: 1.000)
















Epoch  13 | Time:  33 s | Acc: 0.863 (Test: 0.925) | AUC: 0.933 (Test: 0.813) | Precision: 1.000 (Test: 0.667)















Epoch  14 | Time:  32 s | Acc: 0.894 (Test: 0.950) | AUC: 0.935 (Test: 0.830) | Precision: 0.923 (Test: 1.000)















Epoch  15 | Time:  32 s | Acc: 0.887 (Test: 0.950) | AUC: 0.909 (Test: 0.844) | Precision: 0.917 (Test: 1.000)















Epoch  16 | Time:  32 s | Acc: 0.906 (Test: 0.950) | AUC: 0.913 (Test: 0.858) | Precision: 1.000 (Test: 1.000)















Epoch  17 | Time:  33 s | Acc: 0.900 (Test: 0.950) | AUC: 0.911 (Test: 0.854) | Precision: 0.875 (Test: 1.000)









