cross_validation: False
Preprocessing...
Preparing input...
Input was already prepared
Use `python3 -m tensorboard.main --logdir=./logs/` to visualize accuracy and AUC graphs in real time
Training...
Loaded the numpy file dataset...
tcmalloc: large alloc 1587388416 bytes == 0x56145480a000 @  0x7fce375b91e7 0x7fce3517946e 0x7fce351c9c7b 0x7fce351c9d97 0x7fce351c9fe9 0x7fce351ccd7d 0x7fce351cd07b 0x7fce3526e761 0x56144c919544 0x56144c919240 0x56144c98d627 0x56144c9879ee 0x56144c859eb0 0x7fce351b6ef7 0x56144c919437 0x56144c919240 0x56144c98c973 0x56144c9879ee 0x56144c91abda 0x56144c98cd00 0x56144c91aafa 0x56144c988915 0x56144c9879ee 0x56144c91abda 0x56144c988915 0x56144c9879ee 0x56144c91abda 0x56144c989737 0x56144c9879ee 0x56144c9876f3 0x56144ca514c2
Diversity of Training Set: Class 0: 766 Class 1: 235
Diversity of Validation Set: Class 0: 185 Class 1: 66
WARNING:tensorflow:From /content/tbcnn/net.py:17: The name tf.keras.initializers.he_normal is deprecated. Please use tf.compat.v1.keras.initializers.he_normal instead.
/content/tbcnn/net.py:21: UserWarning: `tf.layers.batch_normalization` is deprecated and will be removed in a future version. Please use `tf.keras.layers.BatchNormalization` instead. In particular, `tf.control_dependencies(tf.GraphKeys.UPDATE_OPS)` should not be used (consult the `tf.keras.layers.BatchNormalization` documentation).
  output = tf.layers.batch_normalization(output)
/usr/local/lib/python3.7/dist-packages/keras/legacy_tf_layers/normalization.py:455: UserWarning: `layer.apply` is deprecated and will be removed in a future version. Please use `layer.__call__` method instead.
  return layer.apply(inputs, training=training)
/content/tbcnn/net.py:35: UserWarning: `tf.layers.batch_normalization` is deprecated and will be removed in a future version. Please use `tf.keras.layers.BatchNormalization` instead. In particular, `tf.control_dependencies(tf.GraphKeys.UPDATE_OPS)` should not be used (consult the `tf.keras.layers.BatchNormalization` documentation).
  parallel = tf.layers.batch_normalization(parallel)
Parameter number: 231602
Loading data set 0...
WARNING:tensorflow:From /content/tbcnn/net.py:98: auc (from tensorflow.python.ops.metrics_impl) is deprecated and will be removed in a future version.
Instructions for updating:
The value of AUC returned by this may race with the update so this is deprecated. Please use tf.keras.metrics.AUC instead.
Traceback (most recent call last):
  File "train.py", line 52, in <module>
    train_variants.train_single(relPath('input'), epochs=epochs, size=SIZE)
  File "/content/tbcnn/train_variants.py", line 108, in train_single
    train_loop.train_net(training, test, size=size, epochs=epochs)
  File "/content/tbcnn/train_loop.py", line 113, in train_net
    del next_training
UnboundLocalError: local variable 'next_training' referenced before assignment